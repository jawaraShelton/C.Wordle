using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace C.Wordle
{
    public class Word
    {
        private Boolean flagged;
        private string mot;
        private float score;

        public Boolean Flagged {
            get { return flagged; }
            set { flagged = value; }
        }
        public string Mot {
            get { return mot; }
        }
        public float Score {
            get { return score; }
        }

        Dictionary<char, int> freqs = new Dictionary<char, int>()
        {
            {'E', 1233},
            {'A', 979 },
            {'R', 899 },
            {'O', 754 },
            {'T', 729 },
            {'L', 719 },
            {'I', 671 },
            {'S', 669 },
            {'N', 575 },
            {'C', 477 },
            {'U', 467 },
            {'Y', 425 },
            {'D', 393 },
            {'H', 389 },
            {'P', 367 },
            {'M', 316 },
            {'G', 311 },
            {'B', 281 },
            {'F', 230 },
            {'K', 210 },
            {'W', 195 },
            {'V', 153 },
            {'Z', 40  },
            {'X', 37  },
            {'Q', 29  },
            {'J', 27  }
        };

        Dictionary<char, float[]> pos = new Dictionary<char, float[]>()
        {
            {'A', new float[5]{0.060907127F, 0.131317495F, 0.132613391F, 0.070410367F, 0.027645788F } },
            {'B', new float[5]{0.074730022F, 0.006911447F, 0.024622030F, 0.010367171F, 0.004751620F } },
            {'C', new float[5]{0.085529158F, 0.017278618F, 0.024190065F, 0.065658747F, 0.013390929F } },
            {'D', new float[5]{0.047948164F, 0.008639309F, 0.032397408F, 0.029805616F, 0.050971922F } },
            {'E', new float[5]{0.031101512F, 0.104535637F, 0.076457883F, 0.137365011F, 0.183153348F } },
            {'F', new float[5]{0.058747300F, 0.003455724F, 0.010799136F, 0.015118790F, 0.011231102F } },
            {'G', new float[5]{0.049676026F, 0.005183585F, 0.028941685F, 0.032829374F, 0.017710583F } },
            {'H', new float[5]{0.029805616F, 0.062203024F, 0.003887689F, 0.012095032F, 0.060043197F } },
            {'I', new float[5]{0.014686825F, 0.087257019F, 0.114902808F, 0.068250540F, 0.004751620F } },
            {'J', new float[5]{0.008639309F, 0.000863931F, 0.001295896F, 0.000863931F, 0.000000000F } },
            {'K', new float[5]{0.008639309F, 0.004319654F, 0.005183585F, 0.023758099F, 0.048812095F } },
            {'L', new float[5]{0.038012959F, 0.086825054F, 0.048380130F, 0.069978402F, 0.067386609F } },
            {'M', new float[5]{0.046220302F, 0.016414687F, 0.026349892F, 0.029373650F, 0.018142549F } },
            {'N', new float[5]{0.015982721F, 0.037580994F, 0.060043197F, 0.078617711F, 0.056155508F } },
            {'O', new float[5]{0.017710583F, 0.120518359F, 0.105399568F, 0.057019438F, 0.025053996F } },
            {'P', new float[5]{0.061339093F, 0.026349892F, 0.025053996F, 0.021598272F, 0.024190065F } },
            {'Q', new float[5]{0.009935205F, 0.002159827F, 0.000431965F, 0.000000000F, 0.000000000F } },
            {'R', new float[5]{0.045356371F, 0.115334773F, 0.070410367F, 0.065658747F, 0.091576674F } },
            {'S', new float[5]{0.158099352F, 0.006911447F, 0.034557235F, 0.073866091F, 0.015550756F } },
            {'T', new float[5]{0.064362851F, 0.033261339F, 0.047948164F, 0.060043197F, 0.109287257F } },
            {'U', new float[5]{0.014254860F, 0.080345572F, 0.071274298F, 0.035421166F, 0.000431965F } },
            {'V', new float[5]{0.018574514F, 0.006479482F, 0.021166307F, 0.019870410F, 0.000000000F } },
            {'W', new float[5]{0.035853132F, 0.019006479F, 0.011231102F, 0.010799136F, 0.007343413F } },
            {'X', new float[5]{0.000000000F, 0.006047516F, 0.005183585F, 0.001295896F, 0.003455724F } },
            {'Y', new float[5]{0.002591793F, 0.009935205F, 0.012526998F, 0.001295896F, 0.157235421F } },
            {'Z', new float[5]{0.000000000F, 0.000000000F, 0.000000000F, 0.000000000F, 0.000000000F } }
        };      

        public Word(string w)
        {
            flagged = false;
            mot = w.ToUpper();

            string t = "";
            for(int i=0; i<5; i++)
            {
                char c = mot.Substring(i, 1).ToCharArray()[0];
                score += pos[c][i] + (t.IndexOf(c) < 0 ? freqs[c] : 0);
                t += c;
            }
        }

        public Word()
        {
            flagged = false;
            mot = "";
            score = 0;
        }
    }
}
